<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Equipos de LoL</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #000000;
            background-image: url('https://ddragon.leagueoflegends.com/cdn/img/background/bg-lol.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #ffffff;
            padding: 20px;
        }
        h1 {
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
        }
        .opciones-cantidad {
            margin-bottom: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 12px;
            display: inline-block;
        }
        .opciones-cantidad p {
            margin: 0 0 10px 0;
        }
        .opciones-cantidad button {
            padding: 8px 15px;
            font-size: 16px;
            cursor: pointer;
            border: 2px solid #990000;
            border-radius: 8px;
            background-color: #ff0000;
            color: #ffffff;
            margin: 0 5px;
            transition: background-color 0.3s, transform 0.2s;
            text-transform: uppercase;
            font-weight: bold;
        }
        .opciones-cantidad button:hover {
            background-color: #cc0000;
            transform: translateY(-2px);
        }
        .opciones-cantidad button.active {
            background-color: #cc0000;
            border-color: #ffffff;
            transform: translateY(0);
        }
        .main-content {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        .equipo {
            background-color: rgba(51, 51, 51, 0.9);
            border: 2px solid #555555;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            padding: 25px;
            width: 100%;
            max-width: 350px;
            transition: transform 0.3s ease;
            margin: 15px;
        }
        .equipo:hover {
            transform: scale(1.03);
        }
        h2 {
            color: #ffffff;
            border-bottom: 2px solid #555555;
            padding-bottom: 10px;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }
        ul {
            list-style-type: none;
            padding: 0;
            text-align: left;
        }
        li {
            background-color: rgba(68, 68, 68, 0.8);
            color: #ffffff;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            font-size: 1.1em;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            border: 1px solid #555555;
        }
        li:hover {
            background-color: rgba(85, 85, 85, 0.8);
        }
        .campeon-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            border: 1px solid #c8aa6e;
        }
        .botones-acciones {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .botones-acciones button {
            padding: 12px 25px;
            font-size: 18px;
            cursor: pointer;
            border: 2px solid #990000;
            border-radius: 8px;
            background-color: #ff0000;
            color: #ffffff;
            transition: background-color 0.3s, transform 0.2s;
            text-transform: uppercase;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .botones-acciones button:hover {
            background-color: #cc0000;
            transform: translateY(-2px);
        }
        .botones-acciones button:active {
            transform: translateY(0);
        }
        #jugadores-modal {
            background-color: rgba(26, 26, 26, 0.95);
            color: #ffffff;
            border: 2px solid #c8aa6e;
            border-radius: 12px;
            padding: 2em;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 500px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        #jugadores-modal::backdrop {
            background: rgba(0, 0, 0, 0.7);
        }
        #jugadores-modal textarea {
            width: 100%;
            height: 200px;
            background-color: #2b2b2b;
            color: #ffffff;
            border: 1px solid #555555;
            border-radius: 8px;
            padding: 10px;
            font-size: 1em;
            resize: vertical;
        }
        #jugadores-modal button {
            margin-top: 15px;
        }
        
        .equipo-azul-text {
            color: #4da6ff;
            font-weight: bold;
            margin-right: 10px;
        }
        .equipo-rojo-text {
            color: #ff4d4d;
            font-weight: bold;
            margin-right: 10px;
        }

        .jugadores-inscritos-container {
            position: absolute;
            left: 20px;
            top: 200px;
            background-color: rgba(26, 26, 26, 0.9);
            border: 2px solid #c8aa6e;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            width: 100%;
            max-width: 300px;
            margin: 15px;
        }
        .jugadores-inscritos-container h3 {
            color: #c8aa6e;
            margin-top: 0;
            border-bottom: 2px solid #c8aa6e;
            padding-bottom: 10px;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }
        #tabla-jugadores {
            width: 100%;
            border-collapse: collapse;
            font-size: 1em;
        }
        #tabla-jugadores th, #tabla-jugadores td {
            padding: 10px;
            text-align: left;
        }
        #tabla-jugadores th {
            background-color: #ff0000;
            color: white;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 1px;
            border-radius: 5px 5px 0 0;
        }
        #tabla-jugadores td {
            background-color: rgba(51, 51, 51, 0.8);
            border-bottom: 1px solid #555555;
        }
        #tabla-jugadores tr:last-child td {
            border-bottom: none;
        }

        .equipos-asignados-container {
            position: absolute;
            right: 20px;
            top: 200px;
            background-color: rgba(26, 26, 26, 0.9);
            border: 2px solid #c8aa6e;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            width: 100%;
            max-width: 300px;
            margin: 15px;
        }
        .equipos-asignados-container h3 {
            color: #c8aa6e;
            margin-top: 0;
            border-bottom: 2px solid #c8aa6e;
            padding-bottom: 10px;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }
        .equipo-asignado-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #555555;
        }
        .equipo-asignado-item:last-child {
            border-bottom: none;
        }
        .equipo-asignado-item span {
            font-weight: bold;
        }

        /* Estilos del marcador lineal */
        .marcador-container {
            position: absolute;
            right: 20px;
            top: 500px;
            background-color: rgba(26, 26, 26, 0.9);
            border: 2px solid #c8aa6e;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            width: 100%;
            max-width: 300px;
            margin: 15px;
        }
        .marcador-container h3 {
            color: #c8aa6e;
            margin-top: 0;
            border-bottom: 2px solid #c8aa6e;
            padding-bottom: 10px;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }
        .marcador-equipo {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }
        .equipo-azul-score, .equipo-rojo-score {
            display: flex;
            align-items: center;
            gap: 5px;
            flex-direction: column;
        }
        .marcador-score {
            font-size: 2em;
            font-weight: bold;
        }
        .score-azul {
            color: #4da6ff;
        }
        .score-rojo {
            color: #ff4d4d;
        }
        .marcador-equipo button {
            padding: 5px 15px;
            font-size: 1.2em;
            cursor: pointer;
            border: 1px solid #c8aa6e;
            border-radius: 5px;
            background-color: #2b2b2b;
            color: white;
            transition: background-color 0.2s;
        }
        .marcador-equipo button:hover {
            background-color: #555555;
        }
    </style>
</head>
<body>

    <h1>Generador de Equipos de League of Legends</h1>
    
    <div class="opciones-cantidad">
        <p>Selecciona la cantidad de campeones por equipo:</p>
        <button class="cantidad-btn" data-cantidad="1">1 Campeón</button>
        <button class="cantidad-btn active" data-cantidad="2">2 Campeones</button>
        <button class="cantidad-btn" data-cantidad="3">3 Campeones</button>
        <button class="cantidad-btn" data-cantidad="4">4 Campeones</button>
        <button class="cantidad-btn" data-cantidad="5">5 Campeones</button>
    </div>

    <div class="jugadores-inscritos-container">
        <h3>Jugadores Inscritos</h3>
        <table id="tabla-jugadores">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Jugador</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <div class="equipos-asignados-container">
        <h3>Asignación de Jugadores</h3>
        <div id="equipos-asignados-tabla">
            </div>
    </div>
    
    <div class="marcador-container">
        <h3>Marcador</h3>
        <div class="marcador-equipo">
            <div class="equipo-azul-score">
                <span class="equipo-azul-text">Equipo Azul</span>
                <div>
                    <button onclick="restarVictoriaAzul()">-1</button>
                    <span id="score-azul" class="score-azul marcador-score">0</span>
                    <button onclick="sumarVictoriaAzul()">+1</button>
                </div>
            </div>
            
            <div class="equipo-rojo-score">
                <span class="equipo-rojo-text">Equipo Rojo</span>
                <div>
                    <button onclick="restarVictoriaRojo()">-1</button>
                    <span id="score-rojo" class="score-rojo marcador-score">0</span>
                    <button onclick="sumarVictoriaRojo()">+1</button>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div id="equipo1" class="equipo">
            <h2>Equipo Azul</h2>
            <ul id="lista-equipo1"></ul>
        </div>
        <div id="equipo2" class="equipo">
            <h2>Equipo Rojo</h2>
            <ul id="lista-equipo2"></ul>
        </div>
    </div>
    
    <div class="botones-acciones">
        <button onclick="mostrarModalJugadores()">Inscribir Jugadores</button>
        <button onclick="generarEquipos()">Generar Equipos</button>
    </div>

    <dialog id="jugadores-modal">
        <h3>Ingresa los nombres de los jugadores</h3>
        <p>Escribe un nombre por línea.</p>
        <textarea id="jugadores-textarea"></textarea>
        <button onclick="guardarJugadores()">Guardar y cerrar</button>
    </dialog>

    <script>
        const BIN_ID = '689bd17943b1c97be91cd295';
        const API_KEY = '$2a$10$YFXWAXMkRK0UDugva1F7l.Yp5VKtbxm7TnjGnxG4Xw3raoteMQi1e';
        const API_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

        const campeones = [
            "Aatrox", "Ahri", "Akali", "Akshan", "Alistar", "Amumu", "Anivia", "Annie", "Aphelios", "Ashe", "Aurelion Sol",
            "Azir", "Bard", "Blitzcrank", "Brand", "Braum", "Caitlyn", "Camille", "Cassiopeia", "Cho'Gath", "Corki",
            "Darius", "Diana", "Dr. Mundo", "Draven", "Ekko", "Elise", "Evelynn", "Ezreal", "Fiddlesticks", "Fiora",
            "Fizz", "Galio", "Gangplank", "Garen", "Gnar", "Gragas", "Graves", "Hecarim", "Heimerdinger", "Illaoi",
            "Irelia", "Ivern", "Janna", "Jarvan IV", "Jax", "Jayce", "Jhin", "Jinx", "Kai'Sa", "Kalista", "Karma",
            "Karthus", "Kassadin", "Katarina", "Kayle", "Kayn", "Kennen", "Kha'Zix", "Kindred", "Kled", "Kog'Maw",
            "K'Sante", "LeBlanc", "Lee Sin", "Leona", "Lillia", "Lissandra", "Lucian", "Lulu", "Lux", "Malphite",
            "Malzahar", "Maokai", "Master Yi", "Miss Fortune", "Mordekaiser", "Morgana", "Nami", "Nasus", "Nautilus",
            "Neeko", "Nidalee", "Nocturne", "Nunu y Willump", "Olaf", "Orianna", "Ornn", "Pantheon", "Poppy", "Pyke",
            "Qiyana", "Quinn", "Rakan", "Rammus", "Rek'Sai", "Rell", "Renata Glasc", "Renekton", "Rengar", "Riven",
            "Rumble", "Ryze", "Samira", "Sejuani", "Senna", "Seraphine", "Sett", "Shaco", "Shen", "Shyvana", "Singed",
            "Sion", "Sivir", "Skarner", "Sona", "Soraka", "Swain", "Sylas", "Syndra", "Tahm Kench", "Taliyah", "Talon",
            "Taric", "Teemo", "Thresh", "Tristana", "Trundle", "Tryndamere", "Twisted Fate", "Twitch", "Udyr", "Urgot",
            "Varus", "Vayne", "Veigar", "Vel'Koz", "Vex", "Vi", "Viego", "Viktor", "Vladimir", "Volibear", "Warwick",
            "Wukong", "Xayah", "Xerath", "Xin Zhao", "Yasuo", "Yone", "Yorick", "Yuumi", "Zac", "Zed", "Zeri", "Ziggs",
            "Zilean", "Zoe", "Zyra"
        ];

        let gameState = {
            campeonesPorEquipo: 2,
            jugadoresInscritos: [],
            equiposGenerados: [[], []],
            victoriasAzul: 0,
            victoriasRojo: 0
        };

        const nombreParaURL = {
            "Cho'Gath": "Chogath",
            "Dr. Mundo": "DrMundo",
            "K'Sante": "KSante",
            "LeBlanc": "Leblanc",
            "Lee Sin": "LeeSin",
            "Miss Fortune": "MissFortune",
            "Nunu y Willump": "Nunu",
            "Rek'Sai": "RekSai",
            "Renata Glasc": "Renata",
            "Tahm Kench": "TahmKench",
            "Twisted Fate": "TwistedFate",
            "Vel'Koz": "Velkoz",
            "Xin Zhao": "XinZhao"
        };

        // --- Funciones de Sincronización con JSONbin.io ---
        async function fetchGameState() {
            try {
                const response = await fetch(API_URL, {
                    headers: { 'X-Master-Key': API_KEY }
                });
                const data = await response.json();
                if (data.record) {
                    gameState = data.record;
                    aplicarEstado();
                }
            } catch (error) {
                console.error('Error al obtener el estado del juego:', error);
            }
        }

        async function saveGameState() {
            try {
                await fetch(API_URL, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': API_KEY
                    },
                    body: JSON.stringify(gameState)
                });
            } catch (error) {
                console.error('Error al guardar el estado del juego:', error);
            }
        }

        function aplicarEstado() {
            document.querySelectorAll('.cantidad-btn').forEach(btn => btn.classList.remove('active'));
            const activeButton = document.querySelector(`.cantidad-btn[data-cantidad='${gameState.campeonesPorEquipo}']`);
            if (activeButton) {
                activeButton.classList.add('active');
            }
            document.getElementById('jugadores-textarea').value = gameState.jugadoresInscritos.join('\n');
            mostrarTablaJugadores();
            mostrarEquipos(gameState.equiposGenerados[0], "lista-equipo1", 'equipo-azul-text');
            mostrarEquipos(gameState.equiposGenerados[1], "lista-equipo2", 'equipo-rojo-text');
            mostrarTablaAsignacionEquipos();
            actualizarMarcador();
        }

        // --- Lógica del Juego ---
        document.querySelectorAll('.cantidad-btn').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.cantidad-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                gameState.campeonesPorEquipo = parseInt(button.getAttribute('data-cantidad'));
                generarEquipos();
            });
        });

        function mostrarModalJugadores() {
            document.getElementById('jugadores-modal').showModal();
        }

        function guardarJugadores() {
            const textarea = document.getElementById('jugadores-textarea');
            gameState.jugadoresInscritos = textarea.value
                .split('\n')
                .map(nombre => nombre.trim())
                .filter(nombre => nombre !== '');
            
            document.getElementById('jugadores-modal').close();
            mostrarTablaJugadores();
            generarEquipos();
        }

        function mostrarTablaJugadores() {
            const tbody = document.querySelector('#tabla-jugadores tbody');
            tbody.innerHTML = '';
            if (gameState.jugadoresInscritos.length > 0) {
                gameState.jugadoresInscritos.forEach((jugador, index) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${jugador}</td>
                    `;
                    tbody.appendChild(tr);
                });
            } else {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td colspan="2" style="text-align: center; font-style: italic;">No hay jugadores inscritos</td>`;
                tbody.appendChild(tr);
            }
        }

        function generarEquipos() {
            const campeonesDisponibles = [...campeones];
            const equipo1 = [];
            const equipo2 = [];
            const jugadoresDisponibles = shuffleArray([...gameState.jugadoresInscritos]);
            
            const totalJugadores = jugadoresDisponibles.length;
            const totalNecesarios = gameState.campeonesPorEquipo * 2;

            if (totalNecesarios > campeones.length) {
                alert("No hay suficientes campeones para la cantidad seleccionada.");
                return;
            }

            if (totalJugadores > totalNecesarios) {
                alert(`No hay suficientes espacios para los ${totalJugadores} jugadores. Por favor, reduce la cantidad de jugadores o aumenta el tamaño del equipo.`);
                return;
            }

            if (totalJugadores > 0) {
                const mitad = Math.ceil(totalJugadores / 2);
                const jugadoresEquipo1 = jugadoresDisponibles.splice(0, mitad);
                const jugadoresEquipo2 = jugadoresDisponibles;

                jugadoresEquipo1.forEach(jugador => {
                    const indiceCampeon = Math.floor(Math.random() * campeonesDisponibles.length);
                    const campeon = campeonesDisponibles.splice(indiceCampeon, 1)[0];
                    equipo1.push({ jugador: jugador, campeon: campeon });
                });

                jugadoresEquipo2.forEach(jugador => {
                    const indiceCampeon = Math.floor(Math.random() * campeonesDisponibles.length);
                    const campeon = campeonesDisponibles.splice(indiceCampeon, 1)[0];
                    equipo2.push({ jugador: jugador, campeon: campeon });
                });
                
                while (equipo1.length < gameState.campeonesPorEquipo) {
                    const indiceCampeon = Math.floor(Math.random() * campeonesDisponibles.length);
                    const campeon = campeonesDisponibles.splice(indiceCampeon, 1)[0];
                    equipo1.push({ jugador: null, campeon: campeon });
                }
                while (equipo2.length < gameState.campeonesPorEquipo) {
                    const indiceCampeon = Math.floor(Math.random() * campeonesDisponibles.length);
                    const campeon = campeonesDisponibles.splice(indiceCampeon, 1)[0];
                    equipo2.push({ jugador: null, campeon: campeon });
                }
            } else {
                while (equipo1.length < gameState.campeonesPorEquipo) {
                    const indiceAleatorio = Math.floor(Math.random() * campeonesDisponibles.length);
                    const campeon = campeonesDisponibles.splice(indiceAleatorio, 1)[0];
                    equipo1.push({ jugador: null, campeon: campeon });
                }
                while (equipo2.length < gameState.campeonesPorEquipo) {
                    const indiceAleatorio = Math.floor(Math.random() * campeonesDisponibles.length);
                    const campeon = campeonesDisponibles.splice(indiceAleatorio, 1)[0];
                    equipo2.push({ jugador: null, campeon: campeon });
                }
            }

            gameState.equiposGenerados = [equipo1, equipo2];
            mostrarEquipos(equipo1, "lista-equipo1", 'equipo-azul-text');
            mostrarEquipos(equipo2, "lista-equipo2", 'equipo-rojo-text');
            mostrarTablaAsignacionEquipos();
            saveGameState();
        }

        function mostrarEquipos(equipo, idLista, colorClass) {
            const lista = document.getElementById(idLista);
            lista.innerHTML = '';
            equipo.forEach(item => {
                const li = document.createElement("li");
                
                const campeon = item.campeon;
                let nombreArchivo = nombreParaURL[campeon] || campeon.replace(/[^a-zA-Z]/g, '');
                
                const icono = document.createElement("img");
                icono.src = `https://ddragon.leagueoflegends.com/cdn/15.15.1/img/champion/${nombreArchivo}.png`;
                icono.alt = `Ícono de ${campeon}`;
                icono.classList.add('campeon-icon');

                li.appendChild(icono);
                if (item.jugador) {
                    const spanJugador = document.createElement("span");
                    spanJugador.classList.add(colorClass); // Aplica la clase de color aquí
                    spanJugador.textContent = `${item.jugador}:`;
                    li.appendChild(spanJugador);
                }
                li.appendChild(document.createTextNode(campeon));
                
                lista.appendChild(li);
            });
        }

        function mostrarTablaAsignacionEquipos() {
            const tablaContainer = document.getElementById('equipos-asignados-tabla');
            tablaContainer.innerHTML = '';

            const equipos = ["Azul", "Rojo"];
            const jugadoresAsignados = gameState.equiposGenerados.flatMap((equipo, equipoIndex) => 
                equipo.filter(item => item.jugador !== null).map(item => ({
                    jugador: item.jugador,
                    equipo: equipos[equipoIndex]
                }))
            );
            
            jugadoresAsignados.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('equipo-asignado-item');
                
                const jugadorSpan = document.createElement('span');
                jugadorSpan.textContent = item.jugador;
                itemDiv.appendChild(jugadorSpan);

                const equipoSpan = document.createElement('span');
                equipoSpan.textContent = item.equipo;
                equipoSpan.classList.add(item.equipo === 'Azul' ? 'equipo-azul-text' : 'equipo-rojo-text');
                itemDiv.appendChild(equipoSpan);

                tablaContainer.appendChild(itemDiv);
            });
        }
        
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function actualizarMarcador() {
            document.getElementById('score-azul').textContent = gameState.victoriasAzul;
            document.getElementById('score-rojo').textContent = gameState.victoriasRojo;
        }

        function sumarVictoriaAzul() {
            gameState.victoriasAzul++;
            actualizarMarcador();
            saveGameState();
        }

        function sumarVictoriaRojo() {
            gameState.victoriasRojo++;
            actualizarMarcador();
            saveGameState();
        }

        function restarVictoriaAzul() {
            if (gameState.victoriasAzul > 0) {
                gameState.victoriasAzul--;
                actualizarMarcador();
            }
        }

        function restarVictoriaRojo() {
            if (gameState.victoriasRojo > 0) {
                gameState.victoriasRojo--;
                actualizarMarcador();
            }
        }

        window.onload = () => {
            fetchGameState();
            setInterval(fetchGameState, 3000);
        };
    </script>
</body>
</html>